{"paragraphs":[{"text":"%pyspark\nfrom pyspark.ml.classification import NaiveBayes\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nfrom pyspark.sql import SQLContext\nfrom pyspark import SparkContext\nfrom pyspark.ml.feature import RegexTokenizer, StopWordsRemover, CountVectorizer\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.sql.functions import col\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorAssembler","user":"anonymous","dateUpdated":"2018-11-26T22:05:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871646_376536931","id":"20181114-124520_1753762459","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4263","dateFinished":"2018-11-26T22:05:37+0000","dateStarted":"2018-11-26T22:05:37+0000"},{"text":"%pyspark\nsqlContext = SQLContext(sc)\ndata = sqlContext.read.load(\"s3://amazon-reviews-pds/parquet/\")","user":"anonymous","dateUpdated":"2018-11-26T22:05:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871647_-2048066995","id":"20181114-124822_413483747","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4264","dateFinished":"2018-11-26T22:05:38+0000","dateStarted":"2018-11-26T22:05:37+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=244","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=245"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.sql.functions import when\n\ntargetDf = data.withColumn(\"star_rating\", when(data[\"star_rating\"] < 3, 0).otherwise(1))\n","user":"anonymous","dateUpdated":"2018-11-26T22:05:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871647_1447991853","id":"20181114-133836_1732871392","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4265","dateFinished":"2018-11-26T22:05:38+0000","dateStarted":"2018-11-26T22:05:38+0000"},{"text":"%pyspark\nc_list = ['star_rating', 'review_body']\ndata = targetDf.select(c_list)\ndata.show(5)","user":"anonymous","dateUpdated":"2018-11-26T22:05:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+\n|star_rating|         review_body|\n+-----------+--------------------+\n|          1|After attending a...|\n|          1|Krauss traces the...|\n|          1|Rebecca, a dental...|\n|          1|\\\\\"BARED TO YOU\\\\...|\n|          1|Good characters a...|\n+-----------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543269871647_-186215588","id":"20181114-131307_629737168","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4266","dateFinished":"2018-11-26T22:05:41+0000","dateStarted":"2018-11-26T22:05:38+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=246"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndata_sample = data.sample(withReplacement=False, fraction=0.00001, seed=0).cache()","user":"anonymous","dateUpdated":"2018-11-26T22:05:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871647_-313473346","id":"20181114-132849_1125500491","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4267","dateFinished":"2018-11-26T22:05:41+0000","dateStarted":"2018-11-26T22:05:41+0000"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorAssembler\n\n#train, test = data_sample.randomSplit([0.7, 0.3], seed = 100)\n\nregexTokenizer = RegexTokenizer(inputCol=\"review_body\", outputCol=\"words\", pattern=\"\\\\W\")\n\nadd_stopwords = [\"the\"] \nstopwordsRemover = StopWordsRemover(inputCol=\"words\", outputCol=\"filtered\").setStopWords(add_stopwords)\n\ncountVectors = CountVectorizer(inputCol=\"filtered\", outputCol=\"features\", vocabSize=10000, minDF=1)\n\nlabel_stringIdx = StringIndexer(inputCol = \"star_rating\", outputCol = \"label\")\n\npipeline = Pipeline(stages=[regexTokenizer, stopwordsRemover, countVectors, label_stringIdx])","user":"anonymous","dateUpdated":"2018-11-26T22:05:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871647_288879743","id":"20181126-110745_663819821","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4268","dateFinished":"2018-11-26T22:05:42+0000","dateStarted":"2018-11-26T22:05:42+0000"},{"text":"%pyspark\n# Fit the pipeline to training documents.\n\npipelineFit = pipeline.fit(data_sample)","user":"anonymous","dateUpdated":"2018-11-26T22:05:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871648_-397000956","id":"20181114-132306_714972008","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4269","dateFinished":"2018-11-26T22:05:43+0000","dateStarted":"2018-11-26T22:05:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=247","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=248","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=249"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndataset = pipelineFit.transform(data_sample)\ndataset.show(5)","user":"anonymous","dateUpdated":"2018-11-26T22:05:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+--------------------+--------------------+--------------------+-----+\n|star_rating|         review_body|               words|            filtered|            features|label|\n+-----------+--------------------+--------------------+--------------------+--------------------+-----+\n|          1|Good price, quick...|[good, price, qui...|[good, price, qui...|(10000,[0,5,6,7,1...|  0.0|\n|          1|Having recently v...|[having, recently...|[having, recently...|(10000,[0,1,2,3,4...|  0.0|\n|          1|A brilliant and m...|[a, brilliant, an...|[a, brilliant, an...|(10000,[0,3,5,85,...|  0.0|\n|          1|i can't tell you ...|[i, can, t, tell,...|[i, can, t, tell,...|(10000,[0,1,2,3,4...|  0.0|\n|          1|I was pleasantly ...|[i, was, pleasant...|[i, was, pleasant...|(10000,[1,2,7,9,1...|  0.0|\n+-----------+--------------------+--------------------+--------------------+--------------------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543269871648_1827008008","id":"20181114-133508_1611427582","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4270","dateFinished":"2018-11-26T22:05:44+0000","dateStarted":"2018-11-26T22:05:43+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=250","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=251"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\ntrainingData, testData = dataset.randomSplit([0.8, 0.2], seed = 100)\nprint(\"Training Dataset Count: \" + str(trainingData.count()))\nprint(\"Test Dataset Count: \" + str(testData.count()))","user":"anonymous","dateUpdated":"2018-11-26T22:05:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Training Dataset Count: 1267\nTest Dataset Count: 330\n"}]},"apps":[],"jobName":"paragraph_1543269871648_148391722","id":"20181126-113913_342253237","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4271","dateFinished":"2018-11-26T22:05:45+0000","dateStarted":"2018-11-26T22:05:44+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=252","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=253"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nlr = LogisticRegression(maxIter=20, regParam=0.3, elasticNetParam=0)\nlrModel = lr.fit(trainingData)\npredictions = lrModel.transform(testData)\npredictions \\\n    .select(\"star_rating\",\"review_body\",\"probability\",\"label\",\"prediction\") \\\n    .orderBy(\"probability\", ascending=False) \\\n    .show(n = 10, truncate = 30)","user":"anonymous","dateUpdated":"2018-11-26T22:05:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+------------------------------+------------------------------+-----+----------+\n|star_rating|                   review_body|                   probability|label|prediction|\n+-----------+------------------------------+------------------------------+-----+----------+\n|          1|In 2000, Urania published t...|[0.9995509016918258,4.49098...|  0.0|       0.0|\n|          1|Since a good deal of music ...|[0.9984504308133845,0.00154...|  0.0|       0.0|\n|          1|I have just finished listen...|[0.9982678215662358,0.00173...|  0.0|       0.0|\n|          1|I've been an avid reader of...|[0.9981431115334561,0.00185...|  0.0|       0.0|\n|          1|In The Complete Book of Yea...|[0.9967743918383843,0.00322...|  0.0|       0.0|\n|          1|ich bin absolut begeistert ...|[0.9962248721783592,0.00377...|  0.0|       0.0|\n|          1|It hasn't even been a week ...|[0.9935650877242873,0.00643...|  0.0|       0.0|\n|          1|<BR> This book focuses on t...|[0.9886225107816276,0.01137...|  0.0|       0.0|\n|          1|What everybody says is true...|[0.988204133855736,0.011795...|  0.0|       0.0|\n|          1|I have had this lens for fo...|[0.987679384959338,0.012320...|  0.0|       0.0|\n+-----------+------------------------------+------------------------------+-----+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543269871648_1605514254","id":"20181126-163927_1992449517","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4272","dateFinished":"2018-11-26T22:05:59+0000","dateStarted":"2018-11-26T22:05:45+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=254","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=255","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=256","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=257","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=258","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=259","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=260","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=261","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=262","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=263","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=264","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=265","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=266","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=267","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=268","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=269","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=270","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=271","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=272","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=273","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=274","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=275","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=276","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=277","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=278"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\npredictions.filter(predictions['prediction'] == 1) \\\n    .select(\"star_rating\",\"review_body\",\"probability\",\"label\",\"prediction\") \\\n    .orderBy(\"probability\", ascending=False) \\\n    .show(n = 10, truncate = 30)","user":"anonymous","dateUpdated":"2018-11-26T22:05:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+------------------------------+------------------------------+-----+----------+\n|star_rating|                   review_body|                   probability|label|prediction|\n+-----------+------------------------------+------------------------------+-----+----------+\n|          0|Worst antenna I've ever bou...|[0.42294398067938715,0.5770...|  1.0|       1.0|\n|          0|The order itself arrived in...|[0.3944904853344207,0.60550...|  1.0|       1.0|\n|          0|I hats it, it STINKS! I SME...|[0.18596007861411282,0.8140...|  1.0|       1.0|\n+-----------+------------------------------+------------------------------+-----+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1543269871648_1447537639","id":"20181126-114108_530396024","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4273","dateFinished":"2018-11-26T22:06:00+0000","dateStarted":"2018-11-26T22:05:59+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=279"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n","user":"anonymous","dateUpdated":"2018-11-26T22:06:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543269871649_1642547534","id":"20181126-165210_1693329184","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4274","dateFinished":"2018-11-26T22:06:00+0000","dateStarted":"2018-11-26T22:06:00+0000"},{"text":"%pyspark\nevaluator = MulticlassClassificationEvaluator(predictionCol=\"prediction\")\nevaluator.evaluate(predictions)\n","user":"anonymous","dateUpdated":"2018-11-26T22:06:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.8603493125232257\n"}]},"apps":[],"jobName":"paragraph_1543269871649_1540226899","id":"20181126-165219_277223208","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4275","dateFinished":"2018-11-26T22:06:02+0000","dateStarted":"2018-11-26T22:06:00+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=280","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=281","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=282"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.ml.classification import NaiveBayes\nnb = NaiveBayes(smoothing=1)\nmodel = nb.fit(trainingData)\npredictions = model.transform(testData)\npredictions.filter(predictions['prediction'] == 0) \\\n    .select(\"star_rating\",\"review_body\",\"probability\",\"label\",\"prediction\") \\\n    .orderBy(\"probability\", ascending=False) \\\n    .show(n = 10, truncate = 30)","user":"anonymous","dateUpdated":"2018-11-26T22:06:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+------------------------------+----------------------------+-----+----------+\n|star_rating|                   review_body|                 probability|label|prediction|\n+-----------+------------------------------+----------------------------+-----+----------+\n|          1|Pullhair Rubeye is an extre...| [1.0,2.311174158640157E-17]|  0.0|       0.0|\n|          1|If you thought the Megaman ...|[1.0,1.5901131362650342E-17]|  0.0|       0.0|\n|          1|It you appreciate real coun...| [1.0,5.659464199859473E-18]|  0.0|       0.0|\n|          1|I loved it!!!!<br />I was i...|[1.0,1.4033943340664337E-18]|  0.0|       0.0|\n|          1|Great musical!!!!  So happy...| [1.0,9.570702496282447E-19]|  0.0|       0.0|\n|          1|To begin, it's important to...|[1.0,1.0813851547248817E-19]|  0.0|       0.0|\n|          1|I just got this application...|[1.0,2.4963982355518585E-20]|  0.0|       0.0|\n|          1|A rare and intelligent para...|[1.0,2.2903375964571358E-20]|  0.0|       0.0|\n|          1|What everybody says is true...| [1.0,9.341647266965102E-21]|  0.0|       0.0|\n|          1|I have had this lens for fo...| [1.0,8.709791278921047E-21]|  0.0|       0.0|\n+-----------+------------------------------+----------------------------+-----+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543269871649_-849190104","id":"20181126-175403_1175056263","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4276","dateFinished":"2018-11-26T22:06:04+0000","dateStarted":"2018-11-26T22:06:02+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=283","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=284","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=285"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nevaluator = MulticlassClassificationEvaluator(predictionCol=\"prediction\")\nevaluator.evaluate(predictions)","user":"anonymous","dateUpdated":"2018-11-26T22:06:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.8397377049180327\n"}]},"apps":[],"jobName":"paragraph_1543269871649_526436817","id":"20181126-175400_997325797","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4277","dateFinished":"2018-11-26T22:06:06+0000","dateStarted":"2018-11-26T22:06:04+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=286","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=287","http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=288"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.sql import Row\n\nteste = [\n    Row(review_body='this product is garbage', star_rating=1),\n    Row(review_body='this product is very good', star_rating=1)\n    \n]\ndf_teste = spark.createDataFrame(teste)\n\n\n\ndataset_teste = pipelineFit.transform(df_teste)\npredictions_teste = lrModel.transform(dataset_teste)\n\npredictions_teste.select(\"star_rating\",\"review_body\",\"probability\",\"label\",\"prediction\") \\\n    .orderBy(\"probability\", ascending=False) \\\n    .show(n = 10, truncate = 30)","user":"anonymous","dateUpdated":"2018-11-26T22:06:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-------------------------+------------------------------+-----+----------+\n|star_rating|              review_body|                   probability|label|prediction|\n+-----------+-------------------------+------------------------------+-----+----------+\n|          1|this product is very good|[0.9162716181190721,0.08372...|  0.0|       0.0|\n|          1|  this product is garbage|[0.8331375365098637,0.16686...|  0.0|       0.0|\n+-----------+-------------------------+------------------------------+-----+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1543269871649_-1452494074","id":"20181126-205913_945571183","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4278","dateFinished":"2018-11-26T22:06:07+0000","dateStarted":"2018-11-26T22:06:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-69-217.ec2.internal:4040/jobs/job?id=289"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-11-26T22:06:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543269871650_-1582760187","id":"20181126-213534_329054841","dateCreated":"2018-11-26T22:04:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4279"}],"name":"reviews_amazon_elisa_bruna","id":"2DYH3U9X1","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}